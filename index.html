<!DOCTYPE html>
<html>
<head>
    <title>Smart Resume Analyzer</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
</head>
<script>
{% if skills %}
const ctx = document.getElementById('skillsChart');

new Chart(ctx, {
    type: 'bar',
    data: {
        labels: ['Skills Found', 'Missing Skills'],
        datasets: [{
            label: 'Skill Count',
            data: [{{ skills|length }}, {{ missing_skills|length }}],
            backgroundColor: [
                '#4caf50',
                '#e53935'
            ],
            borderRadius: 8
        }]
    },
    options: {
        responsive: true,
        plugins: {
            legend: { display: false }
        },
        scales: {
            y: {
                beginAtZero: true,
                ticks: { stepSize: 1 }
            }
        }
    }
});
{% endif %}
</script>
<body>
  <div class="container">

    <h1><i class="fa-solid fa-file-lines"></i> Smart Resume Analyzer</h1>

    <form method="POST" enctype="multipart/form-data">
      <input type="file" name="resume" required />
      <button type="submit">
        <i class="fa-solid fa-magnifying-glass"></i> Analyze Resume
      </button>
    </form>

    {% if score %}
    <div class="card fade-in">
      
      <h2>Resume Score</h2>
      <div class="progress">
        <div class="progress-bar" style="width: {{ score }}%;">
          {{ score }}%
        </div>
      </div>

      <p class="role">
        <i class="fa-solid fa-user-tie"></i>
        Best Fit Role: <b>{{ role }}</b>
      </p>

      <h3><i class="fa-solid fa-check"></i> Skills Found</h3>
      <div class="skills">
        {% for s in skills %}
        <span class="tag success">{{ s }}</span>
        {% endfor %}
      </div>

      <h3><i class="fa-solid fa-triangle-exclamation"></i> Missing Skills</h3>
      <div class="skills">
        {% if missing_skills %}
          {% for ms in missing_skills %}
          <span class="tag danger">{{ ms }}</span>
          {% endfor %}
        {% else %}
          <span class="tag success">No missing skills ðŸŽ‰</span>
        {% endif %}
        <h3><i class="fa-solid fa-chart-column"></i> Skill Overview</h3>
<canvas id="skillsChart" height="120"></canvas>
      </div>

      <a href="/history" class="history-link">
        <i class="fa-solid fa-clock-rotate-left"></i> View Resume History
      </a>

    </div>
    {% endif %}
  </div>

  <button class="theme-toggle" onclick="toggleTheme()">
    <i class="fa-solid fa-moon"></i>
  </button>

  <script>
    function toggleTheme() {
      document.body.classList.toggle("dark");
    }
  </script>
  <div class="page">
  <div class="card">
    <!-- ALL your existing content goes here -->
  </div>
</div>
</body>
</html>